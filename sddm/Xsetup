#!/bin/sh
# Xsetup - run as root before the login dialog appears

# Log file for debugging
LOG="/tmp/sddm-xsetup.log"
exec > "$LOG" 2>&1

echo "=== SDDM Xsetup started at $(date) ==="

# Set keyboard layout to US International
echo "Setting keyboard layout..."
setxkbmap -layout us -variant intl

# Wait a moment for displays to be detected
echo "Waiting for displays..."
sleep 2

# List available outputs for debugging
echo "Available outputs:"
xrandr --query

# Configure displays: only use DP-1 (4K HiDPI), turn off DP-2
echo "Configuring displays..."
xrandr --output DP-1 --mode 3840x2160 --rate 60 --scale 0.5x0.5 --primary
xrandr --output DP-2 --off

# Set DPI for HiDPI display (96 DPI * 2 = 192 for 2x scaling)
echo "Setting DPI..."
xrandr --dpi 192

echo "=== Xsetup completed ==="
